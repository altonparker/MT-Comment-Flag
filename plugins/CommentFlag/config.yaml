name: Comment Flagger
id: CommentFlag
key: CommentFlag
description: A plugin which allows readers to flag comments that may need to be removed
schema_version: 2
version: 0.75
blog_config_template: blog_config.tmpl

object_types:
    commentflag: CommentFlag::DataObject

callbacks:
    MT::Comment::post_remove: $CommentFlag::CommentFlag::Plugin::_comment_post_remove

list_actions:
    comment:
        unflag_comment:
            label: Remove Flag
            order: 201
            code:  $CommentFlag::CommentFlag::Plugin::_comment_unflag_page_action
            permission: edit_all_posts

tags:
    function:
        CommentFlagUrl: $CommentFlag::CommentFlag::Plugin::_hdlr_comment_flag_url
        CommentFlagLink: $CommentFlag::CommentFlag::Plugin::_hdlr_comment_flag_link
        CommentFlagIncludes: $CommentFlag::CommentFlag::Plugin::_hdlr_comment_flag_includes

settings:
    comment_flag_require_authentication:
        scope: blog
        default: 1
    comment_flag_tags:
        scope: blog
        default: copyright infringement, libel, sexual content, other

applications:
    cms:
        list_filters:
            comment:
                comment_flag: 
                    label: "Flagged Comments"
                    order: 300
                    handler: $CommentFlag::CommentFlag::Plugin::_comment_flag_quick_filter
upgrade_functions:
    my_function:
        version_limit: 1
        priority: 1
        updater:
            type: commentflag
            label: "Doing something to all entries."
            condition: $CommentFlag::CommentFlag::Plugin::my_upgrade_condition
            code: $CommentFlag::CommentFlag::Plugin::my_upgrade_function
            sql: $CommentFlag::CommentFlag::Plugin::my_upgrade_sql
